# Обзор проекта СпортБаш

## Суть проекта

**СпортБаш** — единая цифровая спортивная экосистема Республики Башкортостан, предназначенная для объединения всех участников спортивного процесса: спортсменов, родителей, тренеров, спортивных организаций и административных органов.

### Основная цель

Создание централизованной платформы для:
- Управления спортивными организациями и секциями
- Регистрации и отслеживания спортсменов
- Организации и проведения спортивных мероприятий
- Мониторинга посещаемости и прогресса
- Аналитики и отчётности по спортивной активности в регионе

---

## Use Cases (Сценарии использования)

### 1. Спортсмен

**Сценарий 1.1: Регистрация и выбор секции**
1. Спортсмен регистрируется на платформе (Email/VK/Telegram)
2. Выбирает роль "Спортсмен" в личном кабинете
3. Заполняет профиль (ФИО, фото, дата рождения, медицинские данные)
4. Просматривает список спортивных организаций на карте
5. Выбирает организацию и секцию
6. Подаёт заявку на вступление в группу или секцию
7. Ждёт подтверждения от директора организации

**Сценарий 1.2: Участие в мероприятиях**
1. Просматривает список предстоящих мероприятий
2. Фильтрует по виду спорта, городу, дате
3. Регистрируется на мероприятие
4. Получает уведомление о подтверждении регистрации
5. Участвует в мероприятии
6. Просматривает результаты и достижения

**Сценарий 1.3: Отслеживание прогресса**
1. Просматривает статистику посещаемости тренировок
2. Видит график прогресса по различным показателям
3. Просматривает список достижений и разрядов
4. Отслеживает участие в соревнованиях

### 2. Родитель

**Сценарий 2.1: Связь с ребёнком**
1. Родитель регистрируется на платформе
2. Получает уникальный ID ребёнка (спортсмена)
3. Вводит ID в личном кабинете для запроса связи
4. Ребёнок подтверждает запрос
5. Родитель получает доступ к данным ребёнка

**Сценарий 2.2: Мониторинг ребёнка**
1. Просматривает профиль ребёнка
2. Отслеживает посещаемость тренировок
3. Видит статистику участия в мероприятиях
4. Просматривает достижения и разряды
5. Получает уведомления о важных событиях

**Сценарий 2.3: Управление несколькими детьми**
1. Добавляет несколько детей по их уникальным ID
2. Переключается между профилями детей
3. Сравнивает статистику разных детей

### 3. Тренер

**Сценарий 3.1: Трудоустройство**
1. Тренер регистрируется и выбирает роль "Тренер"
2. Заполняет профиль (специализация, опыт, образование)
3. Просматривает список свободных организаций
4. Подаёт заявку на работу в организацию
5. Или получает приглашение от директора
6. После одобрения получает доступ к группам

**Сценарий 3.2: Управление группами**
1. Просматривает список своих групп
2. Открывает детальную информацию о группе
3. Видит список спортсменов в группе
4. Отмечает посещаемость на тренировках
5. Просматривает статистику посещаемости группы
6. Одобряет/отклоняет заявки спортсменов на вступление

**Сценарий 3.3: Регистрация на мероприятия**
1. Просматривает список мероприятий
2. Выбирает мероприятие
3. Регистрирует отдельных спортсменов или целые группы
4. Отслеживает статус регистрации

### 4. Директор организации

**Сценарий 4.1: Создание организации**
1. Регистрируется на платформе
2. Создаёт организацию (название, адрес, ИНН, документы)
3. Выбирает город на карте (автокомплит + карта)
4. Указывает координаты организации
5. Организация отправляется на модерацию
6. После одобрения автоматически получает роль "Директор"

**Сценарий 4.2: Управление организацией**
1. Просматривает список своих организаций
2. Добавляет секции (виды спорта)
3. Создаёт тренировочные группы
4. Настраивает расписание для групп
5. Управляет тренерами (одобряет заявки, отправляет приглашения)
6. Одобряет заявки спортсменов на вступление

**Сценарий 4.3: Управление тренерами**
1. Просматривает заявки от тренеров на работу
2. Одобряет или отклоняет заявки
3. Просматривает список свободных тренеров
4. Отправляет приглашения тренерам
5. Назначает тренеров на группы

**Сценарий 4.4: Регистрация на мероприятия**
1. Просматривает список мероприятий
2. Регистрирует спортсменов своей организации
3. Регистрирует целые группы
4. Отслеживает участие организации в мероприятиях

### 5. Главный администратор (Админ РБ)

**Сценарий 5.1: Модерация организаций**
1. Просматривает список организаций на модерации
2. Изучает документы организации
3. Одобряет или отклоняет организацию
4. Оставляет комментарий при отклонении

**Сценарий 5.2: Управление пользователями**
1. Просматривает список всех пользователей
2. Фильтрует по ролям, статусу активности
3. Активирует/деактивирует пользователей
4. Назначает роли (модератор, админ РБ)

**Сценарий 5.3: Мониторинг системы**
1. Просматривает общую статистику (пользователи, организации, мероприятия)
2. Анализирует логи системы (аудит, Django логи)
3. Отслеживает активность пользователей
4. Генерирует отчёты

### 6. Гостевой пользователь

**Сценарий 6.1: Просмотр организаций**
1. Открывает главную страницу
2. Переходит в раздел "Организации"
3. Просматривает карту с организациями
4. Фильтрует по городу и виду спорта
5. Открывает детальную информацию об организации
6. Видит секции, группы, тренеров
7. Для записи регистрируется на платформе

**Сценарий 6.2: Просмотр мероприятий**
1. Переходит в раздел "Мероприятия"
2. Фильтрует по виду спорта, городу, дате
3. Просматривает детальную информацию о мероприятии
4. Для регистрации авторизуется на платформе

---

## Архитектура системы

### Многоуровневая система ролей

```
┌─────────────────────────────────────┐
│      CustomUser (Базовый аккаунт)   │
│  - Email, телефон, ФИО, фото, город │
│  - Общие данные для всех ролей     │
└──────────────┬─────────────────────┘
               │
       ┌───────┴────────┐
       │                │
┌──────▼──────┐  ┌──────▼──────┐
│  UserRole   │  │  UserRole   │
│ (athlete)   │  │  (coach)    │
└──────┬──────┘  └──────┬──────┘
       │                │
┌──────▼──────┐  ┌──────▼──────┐
│AthleteProfile│  │CoachProfile │
│              │  │             │
│- main_sport │  │-specialization│
│- health_group│ │-experience   │
│- medical_info│ │-education    │
└──────────────┘  └──────────────┘
```

### Принцип единого аккаунта

- **Один пользователь = один аккаунт**
- **Один аккаунт = несколько ролей**
- **Общие данные синхронизируются** между всеми ролями
- **Специфичные данные** хранятся отдельно для каждой роли

### Автоматическое назначение ролей

- **Родитель** → автоматически при добавлении ребёнка
- **Директор** → автоматически при создании организации
- **Спортсмен** → выбирается вручную
- **Тренер** → выбирается вручную или назначается директором

---

## Ключевые особенности

### 1. Мультиаккаунтность
- Пользователь может иметь до 4 ролей одновременно
- Переключение между ролями в личном кабинете
- Каждая роль имеет уникальный ID для связи

### 2. Географическая привязка
- Все данные привязаны к Республике Башкортостан
- Интеграция с Яндекс.Картами
- Отображение организаций на карте
- Автокомплит городов с типами населённых пунктов (г., с., д.)

### 3. Система заявок и подтверждений
- Спортсмен → Организация (заявка на вступление)
- Тренер → Организация (заявка на работу)
- Директор → Тренер (приглашение на работу)
- Родитель → Ребёнок (запрос на связь)

### 4. Соответствие ФЗ-152
- Явное согласие на обработку ПДн
- Шифрование медицинских данных (AES-256)
- Хранение данных в РФ
- Аудит всех действий пользователей
- Возможность удаления данных

### 5. Интеграция с Telegram
- Авторизация через Telegram Mini App
- Полный функционал платформы в Telegram
- Адаптированный интерфейс для мобильных устройств

---

## Потоки данных

### Поток 1: Регистрация спортсмена в секцию

```
Спортсмен → Выбор организации → Подача заявки → 
Директор одобряет → Назначение в группу → 
Тренер видит спортсмена → Отмечает посещаемость
```

### Поток 2: Трудоустройство тренера

```
Тренер → Подача заявки в организацию → 
Директор просматривает заявку → Одобрение → 
Создание CoachMembership → Тренер получает доступ к группам
```

### Поток 3: Регистрация на мероприятие

```
Тренер/Директор → Выбор мероприятия → 
Выбор спортсменов/групп → Массовая регистрация → 
Спортсмен получает уведомление → Участие в мероприятии
```

### Поток 4: Связь родителя с ребёнком

```
Родитель → Получение ID ребёнка → 
Запрос связи → Ребёнок подтверждает → 
Родитель получает доступ → Мониторинг прогресса
```

---

## Технологический стек

### Backend
- **Django 5** - основной фреймворк
- **Django REST Framework** - API
- **PostgreSQL/SQLite** - база данных
- **JWT** - аутентификация для мобильных приложений

### Frontend
- **Django Templates** - серверный рендеринг
- **HTMX** - динамические обновления (частично)
- **Fetch API** - AJAX запросы
- **Chart.js** - визуализация данных
- **Yandex Maps API** - карты и геолокация

### Интеграции
- **Telegram Bot API** - авторизация и уведомления
- **VK OAuth 2.0** - авторизация через ВКонтакте
- **Yandex Maps API** - карты и геокодирование
- **MinIO/S3** - хранение файлов

### Безопасность
- **AES-256** - шифрование медицинских данных
- **CSRF Protection** - защита от CSRF атак
- **Session Authentication** - безопасные сессии
- **Audit Logging** - логирование всех действий

---

## Масштабируемость

### Текущие возможности
- Поддержка неограниченного количества пользователей
- Поддержка неограниченного количества организаций
- Масштабируемое хранилище файлов (MinIO/S3)

### Планы на будущее
- Кэширование часто запрашиваемых данных (Redis)
- Очереди задач для фоновых операций (Celery)
- CDN для статических файлов
- Горизонтальное масштабирование (load balancing)
- Микросервисная архитектура (при необходимости)

---

## Соответствие требованиям

### ФЗ-152 "О персональных данных"
- ✅ Явное согласие на обработку ПДн
- ✅ Хранение данных в РФ
- ✅ Шифрование чувствительных данных
- ✅ Право на удаление данных
- ✅ Аудит доступа к данным

### Техническое задание
- ✅ Все основные роли реализованы
- ✅ Мультиаккаунтность
- ✅ Интеграция с Telegram
- ✅ Географическая привязка
- ✅ Система модерации
- ✅ Аналитика и отчётность

---

## Дальнейшее развитие

### Краткосрочные планы
1. Улучшение UI/UX всех кабинетов
2. Расширенная аналитика для организаций
3. Мобильное приложение (iOS/Android)
4. Интеграция с системами учёта (1С)

### Долгосрочные планы
1. Искусственный интеллект для рекомендаций
2. Интеграция с федеральными системами
3. Расширение на другие регионы
4. Международная поддержка
