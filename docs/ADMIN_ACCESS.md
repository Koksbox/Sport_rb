# Доступ главного администратора

## Данные для входа

### Главный администратор по умолчанию

**Email:** `admin@admin.ru`  
**Пароль:** `qwqwqw12`

⚠️ **ВАЖНО:** После первого входа рекомендуется немедленно изменить пароль!

### URL для входа

- **Веб-интерфейс:** `http://localhost:8060/login/` (или ваш домен)
- **Админ-панель Django:** `http://localhost:8060/admin/`

## Создание главного администратора

### Способ 1: Через management команду

```bash
python manage.py create_main_admin
```

Эта команда:
- Создаст главного администратора, если его нет
- Обновит пароль, если администратор уже существует
- Создаст роль `admin_rb`
- Выведет данные для входа

### Способ 2: Через Django shell

```python
from django.contrib.auth import get_user_model
from apps.users.models import UserRole

User = get_user_model()

# Создаём или обновляем администратора
admin, created = User.objects.get_or_create(
    email='admin@admin.ru',
    defaults={
        'first_name': 'Главный',
        'last_name': 'Администратор',
        'is_staff': True,
        'is_superuser': True
    }
)

# Устанавливаем пароль
admin.set_password('qwqwqw12')
admin.is_staff = True
admin.is_superuser = True
admin.save()

# Создаём роль admin_rb
UserRole.objects.get_or_create(
    user=admin,
    role='admin_rb',
    defaults={'is_active': True}
)

print(f'Администратор {"создан" if created else "обновлён"}: {admin.email}')
print(f'Пароль: qwqwqw12')
```

### Способ 3: Через setup_fresh_db

При выполнении команды `python manage.py setup_fresh_db` главный администратор создаётся автоматически.

## Функционал главного администратора

### 1. Управление пользователями
- Просмотр всех пользователей
- Поиск и фильтрация
- Активация/деактивация пользователей
- Просмотр профилей

### 2. Модерация организаций
- Просмотр заявок на создание организаций
- Одобрение/отклонение организаций
- Проверка данных (ИНН, адрес, документы)

### 3. Управление кодами регистрации
- Создание кодов для сотрудников спорткомитета
- Просмотр использованных кодов
- Управление сроками действия

### 4. Просмотр статистики
- Общая статистика системы
- Статистика по ролям
- Статистика организаций
- Статистика мероприятий

### 5. Просмотр логов
- Аудит логи
- Django логи
- Ошибки системы

### 6. Доступ к админ-панели Django
- Полный доступ ко всем моделям
- Управление данными
- Настройка системы

## Безопасность

### Рекомендации:

1. **Измените пароль после первого входа**
   - Используйте сложный пароль (минимум 12 символов)
   - Включите буквы, цифры и специальные символы

2. **Используйте двухфакторную аутентификацию** (если доступна)

3. **Регулярно проверяйте логи системы**
   - Проверяйте подозрительную активность
   - Мониторьте попытки входа

4. **Не передавайте данные для входа третьим лицам**

5. **Используйте HTTPS в production**

6. **Регулярно обновляйте систему**

## Сброс пароля

Если вы забыли пароль главного администратора:

### Через Django shell:

```python
from django.contrib.auth import get_user_model

User = get_user_model()
admin = User.objects.get(email='admin@admin.ru')
admin.set_password('новый_пароль')
admin.save()
print('Пароль изменён')
```

### Через management команду:

```bash
python manage.py create_main_admin
```

Эта команда обновит пароль на `qwqwqw12`.

## Проверка доступа

### Проверка, что вы главный администратор:

1. Войдите в систему
2. Перейдите в личный кабинет: `/dashboard/`
3. Убедитесь, что активна роль `admin_rb`
4. Проверьте наличие раздела "Управление системой"

### Проверка через API:

```bash
curl -X GET http://localhost:8060/api/admin-rb/stats/ \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## Дополнительная информация

Для подробного описания функционала главного администратора см.:
- [Документация роли Admin RB](roles/ROLE_ADMIN_RB.md)

## Контакты

Если у вас возникли проблемы с доступом:
1. Проверьте, что пользователь существует: `User.objects.filter(email='admin@admin.ru').exists()`
2. Проверьте, что пользователь является суперпользователем: `User.objects.get(email='admin@admin.ru').is_superuser`
3. Проверьте, что роль `admin_rb` создана: `UserRole.objects.filter(user__email='admin@admin.ru', role='admin_rb').exists()`
4. Выполните команду `create_main_admin` для восстановления доступа
