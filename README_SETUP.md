# Инструкция по настройке и запуску проекта СпортБаш

## Быстрый старт

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Настройка базы данных

```bash
# Применить миграции
python manage.py migrate

# Создать суперпользователя (опционально)
python manage.py createsuperuser
```

### 3. Загрузка пробных данных

```bash
# Загрузить тестовые данные (города, виды спорта, организации, мероприятия)
python manage.py load_sample_data

# Или с очисткой существующих данных
python manage.py load_sample_data --clear
```

### 4. Запуск сервера

```bash
python manage.py runserver 0.0.0.0:8060
```

Сайт будет доступен по адресу: `http://127.0.0.1:8060`

## Тестовые данные

После выполнения `load_sample_data` будут созданы:

### География
- Регион: Республика Башкортостан
- 12 городов: Уфа, Стерлитамак, Салават, Нефтекамск и др.

### Виды спорта
- 6 категорий (Игровые, Единоборства, Водные, Легкая атлетика, Гимнастика, Зимние)
- Более 20 видов спорта

### Пользователи
- **Спортсмены:**
  - athlete1@test.ru / test123
  - athlete2@test.ru / test123
  - athlete3@test.ru / test123

- **Тренеры:**
  - coach1@test.ru / test123
  - coach2@test.ru / test123

- **Родители:**
  - parent1@test.ru / test123
  - parent2@test.ru / test123

### Организации
- 5 одобренных спортивных организаций в разных городах
- Каждая организация имеет несколько видов спорта

### Мероприятия
- 5 опубликованных мероприятий
- Разные типы: соревнования, фестиваль ГТО, спортивный лагерь
- Разные уровни: городской, республиканский

## Тестирование

### Автоматическое тестирование

```bash
# Запустить тестовый скрипт (требует запущенный сервер)
python test_site.py
```

Скрипт проверит:
- ✅ API endpoints (auth, organizations, events, core и др.)
- ✅ Frontend страницы (главная, вход, регистрация и др.)

### Ручное тестирование

1. **Проверка главной страницы:**
   ```
   http://127.0.0.1:8060/
   ```

2. **Проверка API:**
   ```
   http://127.0.0.1:8060/api/auth/
   http://127.0.0.1:8060/api/organizations/
   http://127.0.0.1:8060/api/events/
   http://127.0.0.1:8060/api/core/health/
   ```

3. **Регистрация и вход:**
   ```
   http://127.0.0.1:8060/register/
   http://127.0.0.1:8060/login/
   ```

## Структура проекта

```
Sport_rb_db/
├── apps/
│   ├── api/              # Централизованное API приложение
│   ├── frontend/         # Frontend приложение
│   ├── authn/            # Аутентификация
│   ├── users/            # Пользователи
│   ├── organizations/    # Организации
│   ├── events/           # Мероприятия
│   └── ...               # Другие модули
├── templates/            # Шаблоны Django
├── static/               # Статические файлы (CSS, JS)
├── config/               # Настройки проекта
├── manage.py
└── requirements.txt
```

## API Endpoints

### Аутентификация
- `GET /api/auth/` - Информация об API аутентификации
- `POST /api/auth/login/` - Вход
- `POST /api/auth/register/` - Регистрация
- `POST /api/auth/vk/` - Вход через ВКонтакте
- `POST /api/auth/telegram/` - Вход через Telegram

### Организации
- `GET /api/organizations/` - Список организаций
- `POST /api/organizations/create/` - Создание организации

### Мероприятия
- `GET /api/events/` - Список мероприятий
- `GET /api/events/<id>/` - Детали мероприятия
- `POST /api/events/<id>/register/` - Регистрация на мероприятие

### Системные
- `GET /api/core/health/` - Проверка здоровья системы
- `GET /api/core/constants/` - Системные константы

## Frontend страницы

- `/` - Главная страница
- `/login/` - Вход
- `/register/` - Регистрация
- `/dashboard/` - Личный кабинет
- `/organizations/` - Список организаций
- `/organizations/create/` - Создание организации
- `/events/` - Список мероприятий
- `/events/<id>/` - Детали мероприятия

## Решение проблем

### Ошибка 404 на `/api/auth/`
✅ **Исправлено:** Добавлен обработчик для корневого пути `/api/auth/`

### Организации не отображаются
1. Проверьте, что загружены пробные данные: `python manage.py load_sample_data`
2. Проверьте статус организаций (должен быть `approved`)

### Мероприятия не отображаются
1. Проверьте статус мероприятий (должен быть `published`)
2. Проверьте дату начала (должна быть в будущем)

### Статические файлы не загружаются
1. В режиме DEBUG статика загружается автоматически
2. Для продакшена: `python manage.py collectstatic`

## Дополнительная информация

- Подробная документация API: `apps/api/README.md`
- Документация Frontend: `apps/frontend/README.md`
- Описание разделения API и Frontend: `README_API_SEPARATION.md`
